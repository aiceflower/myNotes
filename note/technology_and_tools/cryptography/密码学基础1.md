### 零、神奇的问题

#### 为什么加解密算法要公开

​	保密算法可能是未测试的算法。证明某个算法是否强壮的唯一方法就是公开算法，让更多其他密码员对其进行分析。

### 一、基本概念

#### 述语

- NIST：美国国家标准与技术局
- NSA：美国国家安全局
- DES：数据加密标准
- AES：高级加密标准

#### 对称算法

概念：双方共享一个密钥，并使用相同的加密方法和解密方法。

应用：数据加密和完整性检测

#### 非对称算法

​	需要公钥与私钥。

应用：数据加密、数字签名

#### 密码协议

应用：传输层安全(TLS)方案。所有Web浏览器都使用这个方案。

#### 替换密码

​	将字母表中的一个字符用另一个字符替换。

#### 仿射密码

将明文乘以密钥的一部分，然后再加上密钥的剩余部分。

#### 位移密码

​	明文中的每个字母在字母表中移动固定长度的位置。（实际上是替换密码的一个特例）

以上三种密码都不安全（共同特点，明文和密文之间的映射关系是固定的）

#### 密钥长度

只有在蛮力攻击是已知的最好的攻击方法时，才会考虑讨论对称加密算法中密钥长度的问题。

对称算法和非对称算法要求的密钥长度完全不同。对称80位与非对称1024位的安全性相当。

#### 模运算

假设a,r,m $\in$ Z，且 m > 0。如果m除 a-r 可记作：

​	a $\equiv$ r mod m 则 称 m为模数 r为余数。

​	42  $\equiv$  6 mod 9 

#### 安全

##### 无条件安全

​	如果一个密码体制在无限计算资源的情况下也不能被破译，则说明它是无条件安全的。

##### 计算上安全的

​	如果一个密码体制破解代价超过密文信息的价值、破解时间超过密文信息有效期二才满足其一则说明它是是计算上安全的。

##### 加强密码算法的两种本原操作

- 混淆：使密钥与密文间的关系尽可能模糊的加密操作。(常用的是替换)
- 扩散：为了隐藏明文的统计属性，而将一个明文符号的影响扩散到多个密文符号的加密操作。(最简单的扩散是转换)

#### 乘积密码

​	依次使用两个或两个以上基本密码。所有的分组密码都是乘积密码，因为它们都是对数据重复操作的轮组成的。

#### 雪崩效应

​	明文或密钥的一位发生变化，导致密文很多位变化。

### 二、流密码与分组密码

#### 流密码

##### 定义

 单独加密明文的每个位。

##### 流密码的加解密

- 加密：y<sub>i</sub> = e<sub>s<sub>i</sub></sub>(x<sub>i</sub>) $\equiv$ x<sub>i</sub> + s<sub>i</sub> mod 2
- 解密：xi = d<sub>s<sub>i</sub></sub>(y<sub>i</sub>) $\equiv$ Y<sub>i</sub> + s<sub>i</sub> mod 2

##### 特点

- 加密解密使用相同的函数
- 使用简单的模2加法来进行加密 (模2加法与 XOR 运算是等价的)
- s<sub>i</sub> (密钥序列)的生成是流密码的关键所在。流密码安全性完全取决于密钥序列。

**应用**

流密码实现需要的资源少(代码大小，芯片面积等)，对受限的环境(如手机)，流密码更有优势。

#### 随机数生成器



##### 真随机数生成器(TRNG)

​	抛100次硬币并将这100次的结果记作一个100位长的序列。几乎没有人可以产生与这100位相同的序列。真随机数生成器都是基于物理过程，上述的例子有抛硬币、掷骰子、半导体声音、数字电路中的时钟抖动、放射性衰变。密码学中通常用TRNG生成会话密钥。



##### 伪随机数生成器(PRNG)  [不是真正意义上的随机数，是计算出来的]

​	伪随机数序列是递归地执行以下计算得到：s<sub>0</sub> = seed,   s<sub>i+1</sub> = F(s<sub>i</sub>), i = 0,1...

最常见的例子：(线性同余生成器)

​	s<sub>0</sub> = seed ,   s<sub>i+1</sub> $\equiv$ as<sub>i</sub> + b mod m , i = 0,1...   

广泛使用的例子： ANSI C中的rand()

​	s0= 12345 ，  s<sub>i+1</sub> $\equiv$ 1103515245s<sub>i</sub> + 12345 mod 2<sup>31</sup> , i = 0,1...

对于**PRNG**的要求：它必需拥有良好的统计性，意味着它的输出近乎于真随机数序列相同。



##### 加密安全的伪随机数生成器(CSPRNG)

​	它是PRNG的一个特例，拥有以下额外属性：

​	1.它是一种不可预测的PRNG.这意味者给定密钥序列 s<sub>i</sub>，s<sub>i+1</sub> ... s<sub>i+n-1</sub>，的n个输出位，等到后续位s<sub>i+n</sub>，s<sub>i+n+1</sub> ....在计算上是不可行的

​	2.给出上述序列，计算任何之前的位s<sub>i-1</sub> ， s<sub>i-2</sub> ...在计算上是不可行的

注意：只有密码学中才要求 CSPRNG具有不可预知性。其它都需要伪随机数，但并不要求有不可预知性。



#### 牢不可破的密码

##### 一次一密

**条件**

- 通过真随机数生成器得到密钥序列 s<sub>0</sub> , s<sub>1</sub> ,  s<sub>2</sub>...
- 只有合法通信方才知道密钥序列
- 每个密钥序列位s<sub>i</sub> 仅使用一次

**特点**

- 一次一密是无条件安全的

- 密钥长度和明文长度一样长

##### Trivium

一个较新的流密码，密钥长度为80位，基于三个移位寄存器的组合。

#### 分组密码

##### DES

**概述**

​	一种使用56位密钥对64位长度分组进行加密的密码。