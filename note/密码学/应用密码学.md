应用密码学

### 一、密码学概述

#### 1.1 介绍

- 1976 最完整的非技术性说明  The Codebreakers    --- Kahn
- 1976 Diffie ，Hellman 发表 *new directions in cryptograph*  (基于离散对数问题)
  - 公钥密码学革命性的概念
  - 密钥交换新方法
  - 未实现公钥加密，但引发了广泛兴趣
- 1977 DES 美国联邦采纳为信息处理标准
- 1978 RSA  Rivest、Shamir、Adlman (基于大整数因式分解问题)
- 1985 另一个强大的公钥方案  ElGamal (基于离散对数问题)
- 1991 采用第一个国际数字签名标准 (基于rsa)
- 1994 美国政府采用了数字签名标准 (基于ElGamal公钥)

#### 1.2信息安全和密码学

信息安全的目的

- 隐私或机密：对所有信息保密，除了有权看这些信息的人
- 数据完整性：确保未通过未经授权或未知的方式更改信息
- 实体认证或鉴别：实体(人、计算机、信用卡等)身份的确认
- 消息认证：确认消息来源，也称为数据来源身份认证
- 签名：将信息绑定到实体的方法
- 授权：将官方的制裁传递给其它实体去做一些事
- 验证：一种提供及时使用或操纵信息或资源的授权手段
- 访问控制：限制对特权实体的资源访问
- 证书：可信实体对信息的认可
- 时间戳：记录信息创建或存在的时间
- 见证：验证创建者以外的实体创建或存在信息
- 收据：确认已收到信息
- 确认：确认已提供服务
- 所有权：向实体提供使用或转让资源给他人的合法权利的一种手段
- 匿名：隐藏某个过程中涉及的实体的身份
- 不可否认：防止拒绝先前的承诺或行动
- 撤销：撤销认证或授权

<font color="red">通常，信息安全的目标不能仅通过数学算法和协议来单独实现，而是需要程序技术和遵守法律才能达到预期的结果。</font>如信封。有时候安全性需要通过记录信息的文档来实现，如纸币需要特殊的材料。

信息的存储没有发生巨大变化，但是复制和更改信息的能力发生了巨大变化。

信息安全中使用的基本工具之一是签名。它是许多其他服务的基础，例如不可否认，数据源身份验证，标识和见证等。

密码学不是提供信息安全性的唯一方法，而是一组技术。

**信息安全的框架**

信息安全中以下四个构成了一个框架，其他框架将在此框架上推导出。

- 隐私或机密性：机密性是一种服务，用于保留除获得授权的人以外的所有信息的内容。
- 数据完整性：数据完整性是一种解决未经授权的数据更改的服务。
- 身份验证：与识别有关的服务。分为两大类：实体身份验证和数据来源身份验证。
- 不可否认：不可否认性是一项服务，可防止实体拒绝先前的承诺或行动。

**基本密码工具**(基元)基础元件

- 加密方案
- Hash函数
- 数字签名方案

**密码基元分类**

![image-20200216092945730](/Users/alonglamp/Library/Application Support/typora-user-images/image-20200216092945730.png)	

**各基元的评估指标**

- 安全等级
- 功能性
- 操作方法
- 性能
- 易于实现

国际密码学研究协会 the International Association for Cryptologic Research （IACR）

#### 1.3函数知识

**函数**

- f : X → Y is one-to-one 并且 Im(f) = Y，则称f为双射
- 单向函数：x ->f(x) 是容易的，但f(x) -> x是计算上不可行的
- 陷门单向函数

如果f是双射，则$f^{-1}$也是。在密码学中，双射用作加密消息的工具，逆变换用于解密。

如果转换不是双射，则不可能总是解密为唯一的消息。

#### 1.4基本概念和术语

**加密域和共域**

- A ：字母表的有限集合，A = {0,1}
- M：消息空间集合。M中的一个元素称为明文消息
- C：密文消息空间集合。C中的一个无形称为密文。

**加密和解密转换**

- K：密钥空间。K中的一个元素称为一个密钥
- $E_e$：每个元素$e \in K$唯一确定从M到C的双射,用$E_e$表示。$E_e$称为加密函数或加密转换。如果要能够解密则$E_e$必须是双射。
- $D_d$：对于每个$d \in K$，$D_d$表示从C到M的双射（即$D_d$：C→M）。$D_d$称为解密函数或解密转换。
- 构建一个加密方案需要：选择一个消息空间M，一个密文空间C，一个密钥空间K，一组加密变换{$E_e : e \in K$}和一组相应的解密变换{$D_d : d \in K$}。

**通信参与者**

adversary ：enemy, attacker, opponent, tapper, eavesdropper, intruder, and interloper.

敌手：敌人，攻击者，对手，窃听者，窃听者，入侵者和闯入者

加密方案的目标是：穷举攻击是破解密码的最佳方法。

Cryptology is the study of cryptography and cryptanalysis



#### 1.5对称加密

As has been emphasized several times the only information which should be required to be kept secret is the key.

两类对称加密：

- 分组密码
- 流密码。

homomorphic：同态加密

homophonic substitution ciphers：同态替换密码。一对多映射(成对不相交)，解决凯撒密码统计分析(频率)问题

Vigenere 密码 (多表替换密码-分组密码)：e = {p1=3,p2=7,p3=10} 然后再进行凯撒，3个字母一组。

 函数组合(乘积密码): f: S -> T  g: T -> U    g * f : s -> T -> U  = g(f(x))

在一轮中代替被认为是增加了混淆(让K - D关系复杂)，置换则是增加了扩散(让 M - D 关系复杂)。

**流密码**

分组长度为1的密码，对于加密的每个符号加密转换都可以变更。在极有可能发生传输错误的情况下，流密码是有利的，因为它们没有错误传播。

**Vernam cipher**

二进制消息  + 二进制密钥  $c_i = m_i \bigoplus k_i $ 

如果密钥是随机生成，且只使用一次，则 Vernam cipher 称为一次密码。如果密钥多次使用，则有多种方法可以攻击系统。

#### 1.6数字签名

数字签名是认证，授权，不可否认性基础的加密基元。

数字签名的目的是为实体提供一种将其身份绑定到一条信息的方法

M：消息集合

S：签名集合

$S_A$ ：消息到签名的转换

$V_A$：A签名的验证转换 {true,false}

签名过程

A：s = $S_A(m)$   ---->   (m, s)  -- > B

B：获取 $V_A$ , u = $V_A(m, s)$  u = false reject

#### 1.7身份验证 Authentication

具体目标的示例包括<font color="red">访问控制，实体身份验证，消息身份验证，数据完整性，不可否认性和密钥身份验证</font>。

保密和认证是真正分开且独立的信息安全目标。

对于实时的通过发送一些特殊的消息及响应的验证 ---  实体身份验证。

对于有延时的现在需要使用不同的技术来验证消息的始发者 -- 数据源身份验证。

 Identification 申明你是谁

Authentication 证明你是谁

数据源消息认证：通常将消息及额外的信息发送给接收者，以便接收者可以确认发送者的身份。该验证方式隐式提供了数据完整性。



#### 1.8 公钥加密

一个有锁且开着的箱子，只有接收者有钥匙。

对称密码，加密密钥和解密密钥可以互推。公钥密码，例如RSA，公钥是不可以推出私钥的。

非对称密码，并没有强制要求私钥可以推出公钥，只要求私钥与公钥成对即可。但公钥是一定不能推出私钥的。

为了避免歧义：

公钥---私钥  ---- 公钥系统

密钥  --  对称密码



你有没有发现一个问题，xxx是需要证明的。但我们最常使用的加密方案，对称加密，只有一次一密被证明是安全的，其它的都没有被证明。非对称加密，没有一个被证明是安全的。so 你还敢相信密码学吗，还敢使用加密吗......



**对称加密与公钥密码对比**

对称加密

优：

- 可设计为具有很高的数据吞吐率
- 密钥相对较短
- 对称密钥密码可以用作构造各种加密机制的基元，包括伪随机数生成器，哈希函数和计算有效的数字签名方案等。
- 可以构造产生更强的密码。使用乘积密码
- 有很长久的历史

缺：

- 在通信的双方密钥必须保密
- 在大型网络中需要管理很多密钥。有效的密钥管理需要无条件信任的TTP(a trusted third party)
- 在实体A和B之间的两方通信中，合理的加密实践要求密钥经常更改，并且可能在每次通信会话中都要更改

公钥密码

优：

- 只有私钥需要保密，但要保证公钥真实
- 与无条件信任的TTP相反，网络上密钥的管理只需要存在功能上受信任的TTP。根据使用方式的不同，可能只需要“脱机”方式来使用TTP，而不是实时方式。
- 私钥/公钥对可能会在相当长的一段时间内保持不变。
- 许多公钥方案产生了相对有效的数字签名机制。
- 在大型网络中，所需的密钥数量可能比对称密钥方案中的密钥数量少得多。

缺：

- 公钥加密的吞吐量速率比最对称密钥方案要慢。
- 密钥大小通常比对称密钥大得多。
- 没有公开密钥方案被证明是安全的。
- 历史短

总结：

实践中的重点是：

- 公钥密码术有助于有效的签名（尤其是不可否认性）和密钥管理；

- 对称密钥密码术对于加密和某些数据完整性应用程序非常有效。

#### 1.9Hash函数

哈希函数是一种计算有效的可以将任意长度的字符串映射到某个固定长度的字符串的函数。

Hash函数最常见的加密用途是：

- 数字签名
- 数据完整性

#### 1.10协议和机制

密码协议（协议）是一种分布式算法，由一系列步骤定义，这些步骤精确地指定了两个或多个实体实现特定安全目标所需的操作。

机制是一个更通用的术语，涵盖了实现特定安全目标的协议，算法和非加密技术（例如，硬件保护和过程控制）

加密方案、数字签名、Hash函数、伪随机数生成器都可以用来构建协议。



协议失败和机制失败

当某个机制未能达到其预期目标时，就会发生协议失败或机制失败，这种方式使对手获得优势的方式不是直接破坏诸如加密算法之类的基元，而是通过操纵协议或机制本身。

协议或机制可能失败的原因：

- 特定密码基元中的弱点可能会被协议或机制放大
- 假定的安全保证被高估或没有清晰的理解。
- 对适用于广泛基元(如加密)的某些原理的疏忽

#### 1.11.密钥的创建、管理、和认证

TTP是无条件信任的：

​	实体是诚实公证的，它可以访问用户的私钥和私钥，并负责将公钥与标识符关联。

TTP是功能上信任的：

​	实体是诚实公正的，但它无法访问用户的秘密或私钥

**公钥证书**

组成

- 数据部分：实体名称、与实体对应的公钥、其它相关信息(地址、有效期等)
- 签名部分：数据部分上的TTP签名

**伪随机数和序列**

通常随机数生成的算法是公开的，但是随机种子是保密的。

**攻击类别和安全模型**

分类：

- 被动攻击：仅监听通信信道。威胁数据的机密性。
  - 唯密文攻击
  - 已知明文攻击
  - 选择明文攻击
  - 选择密文攻击
  - 选择文本攻击

- 主动攻击：对信道上的数据进行，增加、删除，修改。威胁数据完整性，身份验证和机密性。

**协议攻击**

- 已知密钥攻击：选取先前使用的密码，确定新密钥
- 重放攻击：记录会话，并在稍后某一时间点重播会话或会话的一部分。
- 模仿攻击：假定攻击者知道通信双方的其中一方。
- 字典攻击：通常是对密码进行攻击。比较已知密码的hash值，确定密码。
- 前向搜索攻击：对所有可能的明文使用公钥加密，然后拿当前密文与之前所有加密的结果进行对比，以确定明文。多用在电子交易的32位字段。$2^{32}$
- 交错攻击：

**评估安全性的模型**

- 无条件安全：对称加密中密钥长度与明文长度一样可认为是无条件安全的。
- 复杂性理论安全
- 可证明安全：如果可以证明破解密码方法的难度与解决众所周知的且假设是困难的（通常是数论的）问题（例如整数分解或离散对数的计算）基本一样困难，则认为密码方法是安全的。
- 计算上安全：当前大多数公钥密码
- 自适应安全(Ad hoc security)：每次成功的攻击都需要比感知的对手的固定资源更大的资源级别（例如，时间和空间）。

**对于计算机安全的观点**

工作因子$W_d$ : 最少工作量

历史工作因子$\overline{W_d}$：平均最少工作量

**多大算大？**

![image-20200221110313057](/Users/alonglamp/Library/Application Support/typora-user-images/image-20200221110313057.png)

**Prefix**

![image-20200221110509954](/Users/alonglamp/Library/Application Support/typora-user-images/image-20200221110509954.png)

### 二、数学基础

#### 2.1概率论与数理统计

##### 1.简介

**概率论与数理统计研究什么**

**概率**

- 确定的现象
- 随机现象
- 不确定现象

**统计规律性**

​	大量重复实验会呈现一些统计规律

**随机现象**

​	个别实验结果呈现不确定性，大量重复实验又具有统计规律性的现象。

**概率论**

​	是一门揭示随机现象统计规律性的数学学科

**统计学**

是一门通过收集、整理、分析数据等手段以达到推断或预测考察对象本质或未来的学科。

**关系**

数理统计为概率论面向实际问题提供联系桥梁

概率论为数理统计方法合理性提供理论保证

##### 2.随机事件

**随机实验**

​	对随机现象的观测

​	试验的一个结果称为一个样本，记为 s ，如：观测连续投色子三次出现的结果，则连续三次为一个样本，而不是一次

​	试验所有可能出现的结果的集合称为样本空间，记为S

事件发生 

​	s $\in $ S 则事件发生



#### 2.2信息论

#### 2.3复杂性理论

- 输入大小：用普通二进制法表示输入的总位数

- 整数的输入大小： size(n) = 1 + $ \lfloor lg(n) \rfloor$，为了简化 通常n的大小近似等于 lg(n)

- 如果f是一个至多k次的多项式，每个系数最多是n个非负整数，则f的大小为（k +1）个lg n位。
- 如果A是具有r行，s列且每个非负整数项最多为n的矩阵，则A的大小为rs lg n位

对于运算

- a + b：$O(lg a + lg b ) = O (lg n)$
- a - b：$O(lg a + lg b ) = O (lg n)$
- a $\cdot$ b：$O((lg a) ( lg b )) = O ((lg n)^2)$
- a = qb + r：$O((lg q )(lg b )) = O ((lg n)^2)$

#### 2.4数论